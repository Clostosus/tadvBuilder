<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Choose Your Own Adventure</title>
<style>body {
    font-family: system-ui, sans-serif;
    margin: 2rem;
    line-height: 1.6;
    background-color: #f8fafc;
    color: #1e293b;
}
h1, h2 {
    color: #0f172a;
}
textarea, input, select, button {
    display: block;
    margin-top: 0.5rem;
    margin-bottom: 1rem;
    width: 100%;
    padding: 0.6rem;
    font-size: 1rem;
    border-radius: 8px;
    border: 1px solid #cbd5e1;
    box-sizing: border-box;
}
input[type="text"]::before, textarea::before {
    font-family: inherit;
}
label {
    margin-top: 1rem;
    font-weight: bold;
}
button {
    background-color: #3b82f6;
    color: white;
    border: none;
    padding: 0.6rem 1rem;
    border-radius: 6px;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    font-weight: 500;
}
button:hover {
    background-color: #2563eb;
}
.section {
    background: white;
    border-radius: 12px;
    padding: 1.5rem;
    margin-top: 2rem;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
}
.sectionHighlighted {
    background-color: #e0f2fe;
    border-left: 5px solid #0ea5e9;
}
.bluesidebarP {
    font-size: 0.875rem;
    background-color: #cfeafe;
    padding: 0.5rem 1rem;
    border-left: 4px solid #3b82f6;
    border-radius: 4px;
    margin-bottom: 1rem;
}
#output, #preview, #play-area, #tree-output {
    background: #f1f5f9;
    border: 1px solid #cbd5e1;
    padding: 1rem;
    border-radius: 8px;
    white-space: pre-wrap;
    font-family: ui-monospace, SFMono-Regular, monospace;
}
.choice-inputs {
    margin-bottom: 1rem;
    display: grid;
    gap: 0.5rem;
}
.help {
    font-size: 0.875rem;
    color: #475569;
    margin-top: -0.5rem;
    margin-bottom: 0.5rem;
}

.intro {
    padding: 1rem;
    margin-bottom: 2rem;
    border-radius: 8px;
    font-size: 0.9rem;
}
.intro h1 {
    font-size: 2rem;
    color: #1d4ed8;
    margin-bottom: 0.25rem;
}
.intro h2 {
    margin-top: -0.5rem;
    color: #334155;
    font-weight: normal;
    font-size: 1.2rem;
}

.emoji {
    font-style: normal;
    margin-right: 0.5rem;
}
#play-area button {
    margin-top: 0.5rem;
}
#userNotice {
    font-size: 0.9rem;
}
#storyViewerTemplate {
    white-space: pre-wrap;
    background-color: #e2e8f0;
    padding: 1rem;
    border-radius: 6px;
}</style>
</head>
<body>

<div id="intro" class="intro sectionHighlighted">
    <h1>Choose Your Own Adventure</h1>
    <h2>Ein Tool zum Schreiben verzweigter Entscheidungsgeschichten direkt im Browser</h2>
    <p>Dieses Tool hilft dir beim Erstellen von verzweigten Erlebnissen: sogenannte "Entscheidungsgeschichten". Leserinnen und Leser k√∂nnen durch ihre Entscheidungen den Verlauf beeinflussen. Jede Szene bekommt einen eindeutigen Schl√ºsselnamen, einen Text und eine oder mehrere Auswahlm√∂glichkeiten, die zu anderen Szenen f√ºhren. Du kannst Szenen anlegen, verkn√ºpfen, Vorschauen anzeigen lassen und am Ende das komplette Story-Konstrukt als JSON weiterverwenden oder speichern - alles direkt im Browser, komplett offline und lokal.</p>
</div>

<div id="sceneEditor" class="section">
    <label>Schl√ºsselname der Szene:<span class="help">Ein eindeutiger Bezeichner, z.‚ÄØB. <code>start</code> oder <code>kapitel1</code></span></label>
    <label for="scene-key"></label><input type="text" id="scene-key" placeholder="z.‚ÄØB. start">

    <label>Text der Szene:<span class="help">Der eigentliche Erz√§hltext, der dem Leser angezeigt wird</span></label>
    <label for="scene-text"></label><textarea id="scene-text" rows="4" placeholder="Hier deine Szene eingeben..."></textarea>

    <label>Entscheidungen:<span class="help">Welche M√∂glichkeiten der Leser hat und wohin sie f√ºhren</span></label>
    <div id="choices-container">
        <div class="choice-inputs">
            <label>
                <input type="text" class="choice-text" placeholder="Entscheidungstext">
            </label>
            <label>
                <input type="text" class="choice-next" placeholder="N√§chste Szene (Schl√ºssel)">
            </label>
        </div>
    </div>
    <button onclick="addChoiceField()">Weitere Entscheidung hinzuf√ºgen</button>
    <button onclick="addScene()">Szene speichern</button>
</div>

<div class="section">
    <h2><span class="emoji">üîç</span>Vorschau der aktuellen Szene</h2>
    <div id="preview">(noch keine Vorschau verf√ºgbar)</div>
</div>

<div class="section">
    <h2><span class="emoji">üéÆ</span>Interaktive Vorschau</h2>
    <p class="help">Die Geschichte wird ab der Szene mit dem Schl√ºssel <code>start</code> gestartet</p>
    <button onclick="startStory()">Geschichte starten</button>
    <div id="play-area"></div>
</div>

<div class="section">
    <h2><span class="emoji">üß≠</span>Entscheidungsbaum (ASCII-√úbersicht)</h2>
    <p class="help">Diese einfache Textdarstellung zeigt, welche Szene zu welcher f√ºhrt. Sie wird automatisch aus deinem Story-Aufbau generiert.</p>
    <pre id="tree-output">(noch kein Baum erstellt)</pre>
    <button onclick="renderTree()">Entscheidungsbaum aktualisieren</button>
</div>

<div class="section">
    <h2><span class="emoji"></span> Geschichte importieren / exportieren</h2>
    <p class="help">Lade eine bestehende Geschichte (JSON) oder exportiere deine aktuelle Arbeit.</p>

    <label for="json-file">JSON-Datei laden:</label>
    <input type="file" id="json-file" accept=".json" />

    <button id="import-json">Importieren</button>
    <button id="export-json">Exportieren</button>

    <pre id="import-status">(kein Import durchgef√ºhrt)</pre>
</div>

<div class="section">
<p class="help">Du kannst dein JSON in dieses Template einsetzen, um eine Wiedergabeseite zu erstellen:</p>
<pre id="storyViewerTemplate">
&lt;!DOCTYPE html&gt;
&lt;html lang="de"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;My Story-Viewer&lt;/title&gt;
    &lt;style&gt;
        body {
            font-family: system-ui, sans-serif;
        }
        h2 {
            color: #0f172a;
            margin-bottom: 0.25rem;
        }
        #game {
            background: #f1f5f9;
            border: 1px solid #cbd5e1;
            padding: 1rem;
            border-radius: 8px;
            margin: 0 auto;
            max-width: 800px;
            white-space: pre-wrap;
            box-shadow: 0 4px 12px rgba(0,0,0,0.06);
        }
        #game button {
            background-color: #3b82f6;
            width: 100%;
            color: white;
            border: none;
            padding: 0.6rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 0.5rem;
            font-weight: 500;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="game"&gt;&lt;/div&gt;

&lt;script&gt;
    const story = {
        // INSERT JSON STORY HERE

    };

    function showScene(key)
    {
        const scene = story[key];
        if (!scene) return;

        const container = document.getElementById('game');
        container.innerHTML = ''; // delete previous content/scene

        const title = document.createElement('h2');
        title.textContent = key; container.appendChild(title);

        const text = document.createElement('p');
        text.textContent = scene.text; container.appendChild(text);

        if (!scene.choices || scene.choices.length === 0) return;

        for (const c of scene.choices) {
            const button = document.createElement('button');
            button.textContent = c.text;
            button.addEventListener('click', () =&gt; showScene(c.next));
            container.appendChild(button);
            container.appendChild(document.createElement('br'));
        }
    }

    showScene("start");
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
</div>

<script>var u=class{constructor(e,t="",r=null,o=null){if(this.key=e,this.text=t,this.parent=r,this.choices=new Map,o instanceof Map)for(let[n,c]of o)this.choices.set(n,c);else if(Array.isArray(o))for(let n of o)n.next&&n.text&&this.choices.set(n.next,n.text)}addChoice(e,t){return this.choices.has(t)?!1:(this.choices.set(t,e),!0)}updateChoice(e,t){return this.choices.has(e)?(this.choices.set(e,t),!0):!1}removeChoice(e){return this.choices.delete(e)}getAllChoices(){return Array.from(this.choices,([e,t])=>({text:t,next:e}))}static fromJson(e,t){if(!e||!t)return null;let r=null;if(typeof t=="string")try{r=JSON.parse(t)}catch(n){return console.error(`Failed to parse JSON for scene ${e}: ${n}`),null}else if(typeof t=="object")r=t;else return console.error(`Failed to parse JSON for scene ${e}: Invalid JSON type`),null;if(!r.text||typeof r.text!="string")return console.error(`Scene ${e} missing text property.`),null;let o=new u(e,r.text,null,[]);if(Array.isArray(r.choices))for(let n of r.choices)!n||typeof n.text!="string"||typeof n.next!="string"||o.addChoice(n.text,n.next);return o}toJSON(){let e=[];for(let[t,r]of this.choices.entries())e.push({text:r,next:t});return e.length===0?{text:this.text}:{text:this.text,choices:e}}};var h=class{constructor(e){this.sceneClass=e,this.scenes=new Map,this.root=null}addScene(e){if(!(e instanceof this.sceneClass)||this.scenes.has(e.key))return!1;if(this.scenes.set(e.key,e),!this.root)return this.root=e,!0;if(!e.parent&&this.root&&this.scenes.size>0){let t=this.findParent(e.key);t?(e.parent=t,t.addChoice(e.text||`to ${e.key}`,e.key)):(this.root.addChoice(e.text||`to ${e.key}`,e.key),e.parent=this.root)}return e.parent&&this.scenes.has(e.parent.key)&&this.scenes.get(e.parent.key).addChoice(e.text||`to ${e.key}`,e.key),!0}findParent(e){for(let t of this.scenes.values())if(t.choices instanceof Map&&t.choices.has(e))return t;return null}getScene(e){return this.scenes.get(e)||null}getAllScenesDFS(){if(!this.root)return[];let e=[],t=[];t.push({scene:this.root,depth:0});let r=new Set;for(;t.length>0;){let{scene:o,depth:n}=t.pop();if(r.has(o.key))continue;r.add(o.key),e.push({key:o.key,scene:o,depth:n});let c=[];for(let[i]of o.choices.entries()){let l=this.getScene(i);l?c.push(l):e.push({key:i,scene:null,depth:n+1})}for(let i=c.length-1;i>=0;i--)t.push({scene:c[i],depth:n+1})}return e}toJSON(){let e={};for(let[t,r]of this.scenes.entries())e[t]=r.toJSON();return e}};var f=class{constructor(){throw new Error("Static class")}static async loadFromJson(e,t,r){if(!e||typeof e!="string")return null;let o=null;try{let c=await fetch(e);if(!c.ok)return null;o=await c.json()}catch{return null}if(!o||typeof o!="object")return null;let n=new r(t);for(let[c,i]of Object.entries(o)){let l=t.fromJson(c,i);if(l)n.addScene(l);else return console.warn(`Failed to load scene ${c}`),null}return n.scenes.size===0?null:(console.log("Story loaded from Json"),n)}static async saveToJson(e,t){if(!e||!t||typeof t!="string")return console.error("Ung√ºltige Eingabeparameter in saveToJson: story = ",e,", filename = ",t),!1;let r=e.toJSON();try{let o=JSON.stringify(r),n=new Blob([o],{type:"text/json"}),c=document.createElement("a");c.href=URL.createObjectURL(n),c.download=t,c.click(),URL.revokeObjectURL(c.href),console.log("Story saved to Json")}catch(o){return console.error("Failed to save story to Json:"+o),!1}return!0}};var a=new h(u);function y(s=document.getElementById("tree-output")){if(!s)return;if(!a||!a.root){s.textContent="(noch kein Baum erstellt)";return}let e=a.getAllScenesDFS(),t=[];for(let o=0;o<e.length;o++){let{key:n,scene:c,depth:i}=e[o],l="";for(let d=0;d<i;d++)l+=d===i-1?"|_ ":"   ";n=String(n),c===null?t.push(l+"["+n+"](MISSING)"):t.push(l+n)}let r=t.join(`
`);s.textContent=r}function w(s=document.getElementById("choices-container")){let e=document.createElement("div");e.className="choice-inputs",e.innerHTML=`
        <input type="text" class="choice-text" placeholder="Entscheidungstext">
        <input type="text" class="choice-next" placeholder="N√§chste Szene (Schl√ºssel)">
      `,s.appendChild(e)}function k(){let s=document.getElementById("scene-key").value.trim(),e=document.getElementById("scene-text").value.trim();if(!s||!e)return alert("Bitte Schl√ºssel und Text ausf√ºllen.");let t=document.querySelectorAll(".choice-inputs"),r=new Map;t.forEach(i=>{let l=i.querySelector(".choice-text").value.trim(),d=i.querySelector(".choice-next").value.trim();l&&d&&r.set(d,l)}),a.addScene(new u(s,e,null,r)),g(s),y(),document.getElementById("scene-key").value="",document.getElementById("scene-text").value="";let o=document.getElementById("choices-container");o.innerHTML=`<div class="choice-inputs">
    <input type="text" class="choice-text" placeholder="Entscheidungstext">
    <input type="text" class="choice-next" placeholder="N√§chste Szene (Schl√ºssel)">
  </div>`;let n=document.createElement("div");n.textContent=`‚úÖ Szene '${s}' wurde gespeichert.`,n.style.backgroundColor="#dcfce7",n.style.border="1px solid #22c55e",n.style.color="#166534",n.style.padding="0.5rem 1rem",n.style.borderRadius="6px",n.style.marginTop="1rem",n.style.fontSize="0.95rem",document.querySelectorAll(".section")[0].appendChild(n),setTimeout(()=>n.remove(),3e3)}function g(s){let e=a.getScene(s);if(!e)return;let t=`<p><strong>${e.key}</strong>: ${e.text}</p>`;for(let[r,o]of e.choices.entries())t+=`<button disabled>${o} -> ${r}</button><br>`;document.getElementById("preview").innerHTML=t}function m(){if(!a.root){alert("Keine 'start'-Szene gefunden.");return}S("start")}function S(s){let e=document.getElementById("play-area"),t=a.getScene(s);if(!t){e.innerHTML=`<p><em>Szene '${s}' nicht gefunden.</em></p>`;return}let r=`<p><strong>${t.key}</strong>: ${t.text}</p>`;for(let[o,n]of t.choices.entries())r+=`<button onclick="renderScene('${o}')">${n}</button><br>`;e.innerHTML=r}window.addChoiceField=w;window.addScene=k;window.startStory=m;window.renderTree=y;window.renderPreview=g;window.renderScene=S;var x=document.getElementById("json-file"),v=document.getElementById("import-json"),b=document.getElementById("export-json"),p=document.getElementById("import-status");window.currentStory=null;v.addEventListener("click",async()=>{if(!x.files.length){p.textContent="Bitte zuerst eine JSON-Datei ausw√§hlen.";return}let s=x.files[0],e=URL.createObjectURL(s);try{if(a=await f.loadFromJson(e,u,h),!a){p.textContent="Fehler beim Laden: Story konnte nicht geladen werden.";return}window.currentStory=a,p.textContent=`"${s.name}" erfolgreich geladen (${a.scenes.size} Szenen).`,typeof y=="function"&&y(),typeof m=="function"&&m()}catch(t){p.textContent="Fehler beim Laden: "+t.message}finally{URL.revokeObjectURL(e)}});b.addEventListener("click",()=>{if(!window.currentStory){alert("Keine Story zum Exportieren vorhanden.");return}f.saveToJson(window.currentStory,"story_export.json")});
//# sourceMappingURL=bundle.js.map</script>
</body>
